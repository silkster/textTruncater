!function($){function Plugin(element,options){this.element=element,this.options=$.extend({},defaults,options),this._defaults=defaults,this._name=pluginName;var container=$(element).height("auto");this.container={element:container,height:container.height(),width:container.width()},this.text={selector:options.textSelector||""},this.ellipsis=$('<i class="dotdotdot">&#133;</i>'),this.init()}var pluginName="textTruncator",defaults={maxLines:1,textSelector:"",attributes:[]};Plugin.prototype._setMaxHeight=function(){if(this.text&&this.text.element){var lineHeight,words=this.text.element.find("span");words.length>0&&(lineHeight=words.eq(0).height(),this.container.maxHeight=lineHeight*this.options.maxLines,this.container.element.css("max-height",this.container.maxHeight))}},Plugin.prototype.clean=function(){var plugin=this;ellipsisChar=plugin.ellipsis.text(),txtElement=plugin.text.element,attr=plugin.options.attributes,oTxt=plugin.text.value,tTxt=plugin.text.element.text(),plugin.text.truncated=tTxt.substring(0,tTxt.indexOf(ellipsisChar)+ellipsisChar.length),txtElement.text(plugin.text.truncated),attr&&($.isArray(attr)?$.each(attr,function(){var at=this.toString();txtElement.attr(at,oTxt)}):"string"==typeof attr&&txtElement.attr(attr,oTxt))},Plugin.prototype.init=function(){var plugin=this;""===plugin.text.selector?(plugin.text.element=container,plugin.text.value=$.trim(plugin.container.element.text())):(plugin.text.element=$(plugin.text.selector,plugin.container.element).eq(0),plugin.text.value=$.trim(plugin.text.element.text()));var lastWord,spaceWidth,words=this.text.value.split(" "),spanned='<span style="display:inline-block">'+words.join('</span> <span style="display:inline-block">')+"</span>";plugin.text.element.html(spanned).append(plugin.ellipsis),plugin._setMaxHeight(),plugin.container.maxHeight&&plugin.text.element.height()>plugin.container.maxHeight&&(plugin.text.element.find("span").each(function(){var word=$(this),pos=word.position();if(word.width()>plugin.container.width)return word.siblings("span").hide(),plugin.ellipsis.css({position:"absolute",top:0,right:0,background:"#ffffff",borderLeft:"5px solid #ffffff"}),!1;if(!spaceWidth&&lastWord&&lastWord.position().top==pos.top&&(spaceWidth=Math.ceil(pos.left-lastWord.width())),lastWord&&pos.top+word.height()>plugin.container.maxHeight){var leftPos=Math.ceil(lastWord.position().left)+lastWord.width()+(spaceWidth||0);return plugin.container.width-leftPos>Math.ceil(plugin.ellipsis.width())&&(lastWord=word),!1}lastWord=word}),lastWord.before(plugin.ellipsis),plugin.clean())},$.fn[pluginName]=function(options){return this.each(function(){$.data(this,"plugin_"+pluginName)||$.data(this,"plugin_"+pluginName,new Plugin(this,options))})}}(jQuery,window,document);